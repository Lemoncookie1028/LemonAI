<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lemon AI - Wikipedia Assistant</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            padding: 20px;
        }
        .chat-container {
            max-width: 400px;
            margin: 20px auto;
            background: white;
            padding: 20px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        .chat-box {
            height: 300px;
            overflow-y: auto;
            border: 1px solid #ccc;
            padding: 10px;
            background: #fff;
            text-align: left;
        }
        .user, .bot {
            padding: 8px;
            margin: 5px;
            border-radius: 5px;
        }
        .user { background: #d1e7ff; text-align: right; }
        .bot { background: #e6e6e6; }
        input, button {
            padding: 10px;
            margin: 10px;
            font-size: 16px;
        }
        button {
            cursor: pointer;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:active { background: #218838; }
    </style>
</head>
<body>

<div class="chat-container">
    <h2>üçã Lemon AI - Wikipedia Assistant</h2>
    <div class="chat-box" id="chatBox">
        <div class="bot">Hello! Ask me anything, and I'll fetch info from Wikipedia.</div>
    </div>
    <input type="text" id="userInput" placeholder="Type or speak your question...">
    <button onclick="sendMessage()">Send</button>
    <button onclick="startListening()">üé§ Speak</button>
</div>

<script>
    async function fetchWikipediaSummary(query) {
        let apiUrl = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query)}`;
        try {
            let response = await fetch(apiUrl);
            let data = await response.json();
            return data.extract || "I couldn't find information on that.";
        } catch (error) {
            return "Sorry, I couldn't connect to Wikipedia.";
        }
    }

    async function getResponse(userMessage) {
        userMessage = userMessage.toLowerCase();
        
        if (userMessage.startsWith("tell me about") || userMessage.startsWith("who is") || userMessage.startsWith("what is")) {
            let searchTerm = userMessage.replace("tell me about ", "").replace("who is ", "").replace("what is ", "");
            let summary = await fetchWikipediaSummary(searchTerm);
            return summary;
        }

        let responses = {
            "hello": ["Hello! How can I assist you today?", "Hi there! Need help?"],
            "how are you": ["I'm just a program, but I'm here to help!"],
            "bye": ["Goodbye! Have a great day!"],
            "tell me a joke": [
                "Why did the math book look sad? Because it had too many problems!",
                "Why don‚Äôt skeletons fight? They don‚Äôt have the guts!"
            ],
            "default": ["I'm not sure how to respond. Try asking me something else!"]
        };

        let possibleResponses = responses[userMessage] || responses["default"];
        return possibleResponses[Math.floor(Math.random() * possibleResponses.length)];
    }

    function sendMessage() {
        let inputField = document.getElementById("userInput");
        let chatBox = document.getElementById("chatBox");
        let userMessage = inputField.value.trim();

        if (userMessage === "") return;

        displayMessage("You: " + userMessage, "user");
        
        getResponse(userMessage).then(botResponse => {
            speakAndDisplay(botResponse);
        });

        inputField.value = "";
    }

    function displayMessage(text, className) {
        let chatBox = document.getElementById("chatBox");
        let messageDiv = document.createElement("div");
        messageDiv.className = className;
        messageDiv.textContent = text;
        chatBox.appendChild(messageDiv);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    function speakAndDisplay(text) {
        displayMessage("Lemon AI: " + text, "bot");
        let utterance = new SpeechSynthesisUtterance(text);
        utterance.voice = speechSynthesis.getVoices()[0]; 
        speechSynthesis.speak(utterance);
    }

    function startListening() {
        let recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = "en-US";
        recognition.start();

        recognition.onresult = function(event) {
            let spokenText = event.results[0][0].transcript;
            document.getElementById("userInput").value = spokenText;
            sendMessage();
        };

        recognition.onerror = function(event) {
            console.log("Speech recognition error:", event.error);
        };
    }
</script>

</body>
</html>

